---
layout: post
title: Build and host a simple website with ASP.Net 5 / DNX
date: '2015-11-12T17:38:00.000Z'
author: Frans Lytzen
tags: 
modified_time: '2015-11-12T17:38:24.649Z'
blogger_id: tag:blogger.com,1999:blog-8302357413081836531.post-2683844922546241331
blogger_orig_url: http://blog.lytzen.name/2015/11/build-and-host-simple-website-with.html
---

...always loved about node...<br /><br />explain framework and hosting options...<br /><br />I am doing this on Lin￼ux using Sublime as an editor, just for a bit of variation from my usual Windows&nbsp;+ Visual Studio setup, but there is not much difference between platforms to be honest.<br /><br /><h2>Pre-requisites</h2><h4>Install DNVM and DNX</h4><div>Use the <a href="https://github.com/aspnet/home">appropriate instructions for your operat￼ing system</a>&nbsp;to install the Dot Net Version Manager and the Dot Net Execution environment. DNX is what you really use, DNVM is a tool to allow you to easily manage different versions of DNX on the same machine.h</div><div>If you don't want to use Mono but use the native coreclr, just follow the instructions. If you do what I did and accidentally run "dnvm upgrade" at the end, the Mono version will be installed and set to be the default. If you want to set coreclr to be the default again, just do this;</div><pre class="prettyprint">dnvm alias default 1.0.0-beta8 -r coreclr -a x64<br />dnvm use default<br /></pre><br />At this point I'd also recommend you install Dnx Watcher which can restart your local server every time you change the code. If you are familiar with Node, it's similar to Nodemon (and, yeah, the built-in dnx --watch does not do what you think it does so just ignore that). See <a href="http://www.hanselman.com/blog/IntegratingVisualStudioCodeWithDnxwatchToDevelopASPNET5Applications.aspx">Hanselman's post</a> for a few more details.<br /><pre class="prettyprint">dnu commands install Microsoft.Dnx.Watcher</pre><h4>Text Editor setup</h4><div>You don't particularly <i>need</i> to do anything much with your text editor, but you will probably find editing any actual server code more pleasant if you install some plugins. For both Sublime and Atom, you should install the <a href="http://www.omnisharp.net/">OmniSharp</a> package. For Sublime, you will probably also want to install the <a href="https://packagecontrol.io/packages/Kulture">Kulture</a> package. I believe Visual Studio Code has Omnisharp already built-in, but I haven't tested it.</div><div><br /></div><h2>Serve static pages</h2><div>There are many ways to set up a full ASP.Net website including templates from Visual Studio and Yeoman. However, in order to go back to basics and show that, actually, this can be very simple I am just going to build this manually with the minimal I need to just serve some static files. In the next section I will look at adding a Contact form, which involves just a bit of code. I will, however, use a "full" directory structure, just because it makes it easier to extend things later - but you really don't need to.</div><div>However, if you just want to crack on without doing it all manually, just crack on and do this instead of the following instructions (you need to already have node installed!):<br /><pre class="prettyprint">npm install -g yo generator-aspnet gulp bower<br />yo aspnet<br /></pre><br />...though even the basic web application adds more stuff than I really like.</div>Create a folder and put the following files in there:<br /><h4>project.json</h4><pre class="prettyprint">{<br /> "webroot": "wwwroot",<br /> "version" : "1.0.0-*",<br /><br /> "dependencies" : {<br />  "Microsoft.AspNet.IISPlatformHandler": "1.0.0-beta8",<br />  "Microsoft.AspNet.Server.Kestrel": "1.0.0-beta8",<br />  "Microsoft.AspNet.StaticFiles": "1.0.0-beta8"<br /> },<br /><br /> "commands" : {<br />  "web" : "Microsoft.AspNet.Server.Kestrel"<br /> },<br /><br /> "frameworks" : {<br />  "dnxcore50": {}<br /> }<br />}<br /></pre><br /><h4>Startup.cs</h4><pre class="prettyprint">using System;<br />using Microsoft.AspNet.Builder;<br />using Microsoft.AspNet.Hosting;<br /><br />namespace GenSite<br />{<br />    public class Startup<br />    {<br /><br />        // Configure is called after ConfigureServices is called.<br />        public void Configure(IApplicationBuilder app, IHostingEnvironment env)<br />        {<br />            // Add the IIS handler to allow you to serve this from IIS properly<br />            app.UseIISPlatformHandler();<br />            <br />            //Allow index.html to be served. Remove this if you use mvc controllers to serve default pages<br />            app.UseDefaultFiles();<br />            // Add static files to the request pipeline. Actually serve up the static files and assets. When running on IIS this isn't actually used.<br />            app.UseStaticFiles();<br />        }<br />    }<br />}<br /></pre><br />Then create a subfolder called "wwwroot" and put an index.html file in there with whatever content you need.<br /><br /><h3>Running it locally</h3>In a command line/terminal in the folder you created above first run<br /><pre class="prettyprint">dnu restore</pre>That will pull down the referenced packages. The Atom plugin for OmniSharp may do this for you automatically so you don't have to.<br /><br />To serve it, in the folder, run <br /><pre class="prettyprint">dnx-watch web<br /></pre>(Note, this assumes you installed the dnx-watch package mentioned above. If not, just use "dnx web").<br /><h3>Publish to Azure</h3><div>In order to make this run on Azure, you will need to add a global.json to the root folder with the following content:</div><div><br /></div><div><br /></div><div>If you don't you get this error: xxx</div>